import { Avatar } from "@material-ui/core";
import React, { useEffect, useState } from "react";
import { Link } from "react-router-dom";
import db from "./firebase";
import "./SidebarChat.css";

function SidebarChat({ name, id, key }) {
  /*const [seed, setSeed] = useState("");
   useEffect(() => {
    setSeed(Math.floor(Math.random() * 5000));
  }, []);*/
  const [messages, setMessages] = useState("");
  useEffect(() => {
    if (id) {
      db.collection("rooms")
        .doc(id)
        .collection("messages")
        .orderBy("timestamp", "desc")
        .onSnapshot((snapshot) =>
          setMessages(snapshot.docs.map((doc) => doc.data()))
        );
    }
  }, [id]);
  const createChat = () => {
    const roomName = prompt("enther the name for chat");
    if (roomName) {
      db.collection("rooms").add({
        name: roomName,
      });
    }
  };
  return id ? (
    <Link to={`/rooms/${id}`}>
      <div className="sidebarChat">
        {/*<Avatar src={`https://avatars.dicebear.com/api/human/${seed}.svg`} />*/}
        <Avatar src="data:image/jpeg;base64,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" />
        <div className="sidebar_chatInfo">
          <h2>{name}</h2>
          <p>{messages[0]?.message}</p>
        </div>
      </div>
    </Link>
  ) : (
    <div onClick={createChat} className="sidebarChat">
      <h2>Add new Chat</h2>
    </div>
  );
}

export default SidebarChat;
